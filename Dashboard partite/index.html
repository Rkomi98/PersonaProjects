<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Calendario Volley 2025/26 - Avis, Zeronove, Carugate</title>
    <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
    <style>
        :root {
  --color-white: rgba(255, 255, 255, 1);
  --color-black: rgba(0, 0, 0, 1);
  --color-cream-50: rgba(252, 252, 249, 1);
  --color-cream-100: rgba(255, 255, 253, 1);
  --color-gray-200: rgba(245, 245, 245, 1);
  --color-gray-300: rgba(167, 169, 169, 1);
  --color-gray-400: rgba(119, 124, 124, 1);
  --color-slate-500: rgba(98, 108, 113, 1);
  --color-brown-600: rgba(94, 82, 64, 1);
  --color-charcoal-700: rgba(31, 33, 33, 1);
  --color-charcoal-800: rgba(38, 40, 40, 1);
  --color-slate-900: rgba(19, 52, 59, 1);
  --color-teal-300: rgba(50, 184, 198, 1);
  --color-teal-400: rgba(45, 166, 178, 1);
  --color-teal-500: rgba(33, 128, 141, 1);
  --color-teal-600: rgba(29, 116, 128, 1);
  --color-teal-700: rgba(26, 104, 115, 1);
  --color-blue-500: rgba(59, 130, 246, 1);
  --color-brown-600-rgb: 94, 82, 64;
  --color-teal-500-rgb: 33, 128, 141;
  --color-slate-900-rgb: 19, 52, 59;
  --color-background: var(--color-cream-50);
  --color-surface: var(--color-cream-100);
  --color-text: var(--color-slate-900);
  --color-text-secondary: var(--color-slate-500);
  --color-primary: var(--color-teal-500);
  --color-border: rgba(var(--color-brown-600-rgb), 0.2);
  --color-card-border: rgba(var(--color-brown-600-rgb), 0.12);
  --font-family-base: "FKGroteskNeue", "Geist", "Inter", -apple-system, BlinkMacSystemFont, "Segoe UI", Roboto, sans-serif;
  --font-size-sm: 12px;
  --font-size-base: 14px;
  --font-size-lg: 16px;
  --font-size-xl: 18px;
  --font-size-2xl: 20px;
  --font-size-3xl: 24px;
  --space-8: 8px;
  --space-12: 12px;
  --space-16: 16px;
  --space-20: 20px;
  --space-24: 24px;
  --space-32: 32px;
  --radius-base: 8px;
  --radius-lg: 12px;
  --shadow-sm: 0 1px 3px rgba(0, 0, 0, 0.04), 0 1px 2px rgba(0, 0, 0, 0.02);
  --shadow-md: 0 4px 6px -1px rgba(0, 0, 0, 0.04), 0 2px 4px -1px rgba(0, 0, 0, 0.02);
}

@media (prefers-color-scheme: dark) {
  :root {
    --color-gray-400-rgb: 119, 124, 124;
    --color-teal-300-rgb: 50, 184, 198;
    --color-gray-300-rgb: 167, 169, 169;
    --color-gray-200-rgb: 245, 245, 245;
    --color-background: var(--color-charcoal-700);
    --color-surface: var(--color-charcoal-800);
    --color-text: var(--color-gray-200);
    --color-text-secondary: rgba(var(--color-gray-300-rgb), 0.7);
    --color-primary: var(--color-teal-300);
    --color-border: rgba(var(--color-gray-400-rgb), 0.3);
    --color-card-border: rgba(var(--color-gray-400-rgb), 0.2);
  }
}

@font-face {
  font-family: 'FKGroteskNeue';
  src: url('https://r2cdn.perplexity.ai/fonts/FKGroteskNeue.woff2') format('woff2');
}

* {
  box-sizing: border-box;
  margin: 0;
  padding: 0;
}

body {
  font-family: var(--font-family-base);
  background-color: var(--color-background);
  color: var(--color-text);
  line-height: 1.5;
  padding: var(--space-20);
}

.header {
  text-align: center;
  margin-bottom: var(--space-32);
}

.header h1 {
  font-size: var(--font-size-3xl);
  margin-bottom: var(--space-8);
  color: var(--color-text);
}

.header p {
  color: var(--color-text-secondary);
  font-size: var(--font-size-base);
}

.filters {
  display: flex;
  gap: var(--space-16);
  margin-bottom: var(--space-24);
  flex-wrap: wrap;
  align-items: center;
}

.filter-group {
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.filter-group label {
  font-size: var(--font-size-sm);
  font-weight: 500;
  color: var(--color-text);
}

.filter-group select {
  padding: var(--space-8) var(--space-12);
  border: 1px solid var(--color-border);
  border-radius: var(--radius-base);
  background-color: var(--color-surface);
  color: var(--color-text);
  font-size: var(--font-size-base);
  min-width: 200px;
}

.view-tabs {
  display: flex;
  gap: var(--space-8);
  margin-bottom: var(--space-24);
  border-bottom: 1px solid var(--color-border);
}

.view-tab {
  padding: var(--space-12) var(--space-20);
  background: transparent;
  border: none;
  border-bottom: 2px solid transparent;
  color: var(--color-text-secondary);
  font-size: var(--font-size-base);
  font-weight: 500;
  cursor: pointer;
  transition: all 0.2s;
}

.view-tab:hover {
  color: var(--color-text);
}

.view-tab.active {
  color: var(--color-primary);
  border-bottom-color: var(--color-primary);
}

.view-content {
  display: none;
}

.view-content.active {
  display: block;
}

.legend {
  display: flex;
  gap: var(--space-24);
  margin-bottom: var(--space-24);
  padding: var(--space-16);
  background-color: var(--color-surface);
  border-radius: var(--radius-base);
  border: 1px solid var(--color-card-border);
  flex-wrap: wrap;
}

.legend-item {
  display: flex;
  align-items: center;
  gap: var(--space-8);
}

.legend-color {
  width: 20px;
  height: 20px;
  border-radius: 4px;
  border: 1px solid var(--color-border);
}

.legend-color.avis {
  background-color: #ffffff;
  border: 2px solid #333;
}

.legend-color.zeronove {
  background-color: #000000;
}

.legend-color.carugate {
  background-color: #3b82f6;
}

/* Table View */
.table-container {
  overflow-x: auto;
  background-color: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-sm);
}

table {
  width: 100%;
  border-collapse: collapse;
}

thead {
  background-color: var(--color-surface);
  border-bottom: 2px solid var(--color-border);
}

th {
  padding: var(--space-12) var(--space-16);
  text-align: left;
  font-weight: 600;
  font-size: var(--font-size-sm);
  color: var(--color-text);
  white-space: nowrap;
}

td {
  padding: var(--space-12) var(--space-16);
  border-bottom: 1px solid var(--color-card-border);
  font-size: var(--font-size-sm);
}

tr:last-child td {
  border-bottom: none;
}

tr:hover {
  background-color: rgba(var(--color-teal-500-rgb), 0.05);
}

.overlap-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  background-color: rgba(255, 84, 89, 0.15);
  color: #ff5459;
}

.no-overlap-badge {
  display: inline-block;
  padding: 2px 8px;
  border-radius: 4px;
  font-size: 11px;
  font-weight: 600;
  background-color: rgba(33, 128, 141, 0.15);
  color: var(--color-teal-500);
}

/* Calendar View */
.calendar-container {
  display: grid;
  gap: var(--space-24);
}

.week-card {
  background-color: var(--color-surface);
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  padding: var(--space-20);
  box-shadow: var(--shadow-sm);
}

.week-header {
  font-size: var(--font-size-lg);
  font-weight: 600;
  margin-bottom: var(--space-16);
  color: var(--color-text);
  padding-bottom: var(--space-8);
  border-bottom: 1px solid var(--color-border);
}

.matches-grid {
  display: grid;
  gap: var(--space-12);
}

.match-item {
  padding: var(--space-12);
  border-radius: var(--radius-base);
  border: 1px solid var(--color-card-border);
  display: flex;
  flex-direction: column;
  gap: var(--space-8);
}

.match-item.avis {
  background-color: rgba(255, 255, 255, 0.5);
  border-left: 4px solid #ffffff;
  border-left-color: #333;
}

.match-item.zeronove {
  background-color: rgba(0, 0, 0, 0.08);
  border-left: 4px solid #000000;
}

.match-item.carugate {
  background-color: rgba(59, 130, 246, 0.08);
  border-left: 4px solid #3b82f6;
}

@media (prefers-color-scheme: dark) {
  .match-item.avis {
    background-color: rgba(255, 255, 255, 0.05);
  }
}

.match-header {
  display: flex;
  justify-content: space-between;
  align-items: center;
  gap: var(--space-8);
}

.match-team {
  font-weight: 600;
  font-size: var(--font-size-base);
}

.match-date {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.match-details {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

.match-vs {
  font-size: var(--font-size-sm);
  color: var(--color-text);
}

.match-location {
  font-size: var(--font-size-sm);
  color: var(--color-text-secondary);
}

/* Map View */
#map {
  height: 600px;
  width: 100%;
  border-radius: var(--radius-lg);
  border: 1px solid var(--color-card-border);
  box-shadow: var(--shadow-md);
}

.leaflet-popup-content {
  font-family: var(--font-family-base);
}

.popup-content h3 {
  margin: 0 0 8px 0;
  font-size: var(--font-size-base);
  font-weight: 600;
}

.popup-content p {
  margin: 4px 0;
  font-size: var(--font-size-sm);
}

.popup-link {
  display: inline-block;
  margin-top: 8px;
  padding: 6px 12px;
  background-color: var(--color-primary);
  color: white;
  text-decoration: none;
  border-radius: 4px;
  font-size: var(--font-size-sm);
  font-weight: 500;
}

.popup-link:hover {
  background-color: var(--color-teal-600);
}

.no-matches {
  text-align: center;
  padding: var(--space-32);
  color: var(--color-text-secondary);
  font-size: var(--font-size-base);
}

@media (max-width: 768px) {
  .filters {
    flex-direction: column;
    align-items: stretch;
  }
  
  .filter-group select {
    width: 100%;
  }
  
  .view-tabs {
    overflow-x: auto;
  }
  
  #map {
    height: 400px;
  }
}
    </style>
</head>
<body>
    <div class="header">
        <h1>Calendario Volley 2025/26</h1>
        <p>Avis Cernusco, ASD Zeronove, Polisportiva Carugate</p>
    </div>

    <div class="legend">
        <div class="legend-item">
            <div class="legend-color avis"></div>
            <span>Avis Cernusco</span>
        </div>
        <div class="legend-item">
            <div class="legend-color zeronove"></div>
            <span>ASD Zeronove</span>
        </div>
        <div class="legend-item">
            <div class="legend-color carugate"></div>
            <span>Polisportiva Carugate</span>
        </div>
    </div>

    <div class="filters">
        <div class="filter-group">
            <label for="team-filter">Filtra per Squadra</label>
            <select id="team-filter">
                <option value="all">Tutte le squadre</option>
                <option value="avis">Avis Cernusco</option>
                <option value="zeronove">ASD Zeronove</option>
                <option value="carugate">Polisportiva Carugate</option>
            </select>
        </div>
        <div class="filter-group">
            <label for="week-filter">Filtra per Settimana</label>
            <select id="week-filter">
                <option value="all">Tutte le settimane</option>
            </select>
        </div>
    </div>

    <div class="view-tabs">
        <button class="view-tab active" data-view="table">Tabella Settimanale</button>
        <button class="view-tab" data-view="calendar">Calendario</button>
        <button class="view-tab" data-view="map">Mappa</button>
    </div>

    <div id="table-view" class="view-content active">
        <div class="table-container">
            <table id="weekly-table">
                <thead>
                    <tr>
                        <th>Settimana</th>
                        <th>Date</th>
                        <th>Avis Cernusco</th>
                        <th>ASD Zeronove</th>
                        <th>Polisportiva Carugate</th>
                        <th>Sovrapposizioni</th>
                    </tr>
                </thead>
                <tbody id="weekly-table-body">
                </tbody>
            </table>
        </div>
    </div>

    <div id="calendar-view" class="view-content">
        <div class="calendar-container" id="calendar-container">
        </div>
    </div>

    <div id="map-view" class="view-content">
        <div id="map"></div>
    </div>

        <script type="application/json" id="calendar-data">
[
  {
    "settimana": "2025-W44",
    "partite": [
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-10-29",
        "giorno": "Wednesday",
        "ora": "21.00",
        "casa": "CEM TORRICELLI",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "ITC VERRI 1'' PIANO",
        "localita": "MILANO - VIA LATTANZIO"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2025-10-30",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "O.F.I.",
        "ospite": "ASD ZERONOVE",
        "campo": "PALESTRA COMUNALE",
        "localita": "INZAGO - VIA BRAMBILLA"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-10-31",
        "giorno": "Friday",
        "ora": "21.00",
        "casa": "AD ASTRA ASD - DRACO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "SCUOLA MEDIA BUONARROTI",
        "localita": "MILANO - VIA SCIALOIA"
      }
    ]
  },
  {
    "settimana": "2025-W45",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2025-11-06",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "A.S.D. NEW VOLLEY ADDA",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-11-06",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "NUOVA UMPLA BRESSO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-11-07",
        "giorno": "Friday",
        "ora": "21.00",
        "casa": "GEAS VOLLEY ASD",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "SCUOLA EL. MARTIRI DELLA LIBERTA''",
        "localita": "SESTO SAN GIOVANNI - VIA FIORANI (DI FRONTE AL CIVICO 93)"
      }
    ]
  },
  {
    "settimana": "2025-W46",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2025-11-13",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "GEAS VOLLEY ASD",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-11-14",
        "giorno": "Friday",
        "ora": "21.00",
        "casa": "BOLLATE VOLLEY",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALAZZETTO DELLO SPORT 'CARLO GALIMBERTI'",
        "localita": "BOLLATE - VIA VARALLI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-11-14",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POL. SAN GIORGIO",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALESTRA COMUNALE LISCATE",
        "localita": "LISCATE - VIA DANTE ALIGHIERI"
      }
    ]
  },
  {
    "settimana": "2025-W47",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2025-11-20",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "A.S.D. POL. GS RODANO",
        "ospite": "ASD ZERONOVE",
        "campo": "PALAZZETTO COMUNALE C/O SM",
        "localita": "RODANO - VIA TURATI (LARGO 11 SETTEMBRE 2001)"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-11-20",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "MARTESANA VOLLEY COLOGNO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-11-21",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "GONZAGA YOUNG",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2025-W48",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2025-11-26",
        "giorno": "Wednesday",
        "ora": "21.15",
        "casa": "BILLA VOLLEY MILANO U25",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "I.I.S. V.F. PARETO - CAMPO 1",
        "localita": "MILANO - VIA LITTA MODIGNANI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2025-11-27",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "SSD SRL POL. SAN GIULIANO",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-11-28",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "VOLLEY LUCERNATE",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "S.E. DI LUCERNATE",
        "localita": "RHO - LUCERNATE - VIA GIULIO CESARE - INGRESSO VIA VERBAN"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-11-28",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "CITTA' DI OPERA",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALESTRA COMUNALE OPERA",
        "localita": "OPERA - VIA DANTE ALIGHIERI"
      }
    ]
  },
  {
    "settimana": "2025-W49",
    "partite": [
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-12-03",
        "giorno": "Wednesday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "PIZZAUT PALLAVOLO CASSINA ROSSA",
        "campo": "PALESTRA SCUOLE MEDIE CLEMENTE BARONI NUOVA",
        "localita": "CARUGATE - VIA S. FRANCESCO D'ASSISI (ANGOLO VIA FIDELINA"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2025-12-04",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "A.S.D. ORATORIO OGGIONO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2025-12-05",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "ASD ASS. GENITORI SCUOLE",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA MEDIA GRAMSCI",
        "localita": "MILANO - VIA FRANCO TOSI"
      }
    ]
  },
  {
    "settimana": "2025-W50",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2025-12-09",
        "giorno": "Tuesday",
        "ora": "21.15",
        "casa": "VOLLEY BARZANO'",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "CENTRO SPORTIVO PAOLO VI",
        "localita": "BARZANO' - VIA GIOVANNI PAOLO XXIII"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2025-12-11",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "ASD PGS ARDOR",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-12-11",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "O.F.I.",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALESTRA COMUNALE",
        "localita": "INZAGO - VIA BRAMBILLA"
      }
    ]
  },
  {
    "settimana": "2025-W51",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2025-12-16",
        "giorno": "Tuesday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "PALLAVOLO GSA",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2025-12-17",
        "giorno": "Wednesday",
        "ora": "21.00",
        "casa": "CEM TORRICELLI",
        "ospite": "ASD ZERONOVE",
        "campo": "CENTRO SCOLASTICO UNIONE EUROPEA",
        "localita": "MILANO - VIA SAN DIONIGI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2025-12-19",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "A.S.D. NEW VOLLEY ADDA",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W02",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-01-09",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "CORALYA LISSONE VOLLEY TEAM",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALAZZETTO PIERMARINI",
        "localita": "LISSONE - VIA BERNINI"
      }
    ]
  },
  {
    "settimana": "2026-W03",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-01-15",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "REDSTAMP VOLLEY VALLE DEL LAMBRO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-01-16",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POL. SAN GIORGIO",
        "ospite": "ASD ZERONOVE",
        "campo": "PALESTRA COMUNALE LISCATE",
        "localita": "LISCATE - VIA DANTE ALIGHIERI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-01-16",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "A.S.D. POL. GS RODANO",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W04",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-01-22",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "GONZAGA YOUNG",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-01-22",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "UNION VOLLEY MARIANO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALAZZETTO DELLO SPORT",
        "localita": "MARIANO COMENSE - VIA SANT'ANTONIO DA PADONA"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-01-23",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "SSD SRL POL. SAN GIULIANO",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "SCUOLA MEDIA E.FERMI",
        "localita": "SAN GIULIANO MILANESE - VIA SESTO GALLO"
      }
    ]
  },
  {
    "settimana": "2026-W05",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-01-29",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "BILLA VOLLEY MILANO U25",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-01-30",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "CITTA' DI OPERA",
        "ospite": "ASD ZERONOVE",
        "campo": "PALESTRA COMUNALE OPERA",
        "localita": "OPERA - VIA DANTE ALIGHIERI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-01-30",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "ASD ASS. GENITORI SCUOLE",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W06",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-02-05",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "PIZZAUT PALLAVOLO CASSINA ROSSA",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-02-06",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "GEAS VOLLEY ASD",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "ISTITUTO ERASMO DA ROTTERDAM",
        "localita": "SESTO SAN GIOVANNI - VIA CANTORE (ANG.V.LE ITALIA 409)"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-02-06",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "ASD PGS ARDOR",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "CENTRO SALESIANO MELZO",
        "localita": "MELZO - VIA FORMENTI"
      }
    ]
  },
  {
    "settimana": "2026-W07",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-02-12",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "O.F.I.",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-02-12",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "AD ASTRA ASD - DRACO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-02-13",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "CEM TORRICELLI",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W08",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-02-19",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "A.S.D. NEW VOLLEY ADDA",
        "ospite": "ASD ZERONOVE",
        "campo": "PALAZZETTO SANSONA",
        "localita": "CASSANO D'ADDA - VIA PAPA GIOVANNI XXIII"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-02-20",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "NUOVA UMPLA BRESSO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "TENSOSTRUTTURA BRESSO",
        "localita": "BRESSO - VIA DON MINZONI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-02-20",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "GEAS VOLLEY ASD",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W09",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-02-26",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "BOLLATE VOLLEY",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-02-27",
        "giorno": "Friday",
        "ora": "21.00",
        "casa": "GEAS VOLLEY ASD",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA EL. MARTIRI DELLA LIBERTA''",
        "localita": "SESTO SAN GIOVANNI - VIA FIORANI (DI FRONTE AL CIVICO 93)"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-02-27",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "POL. SAN GIORGIO",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W10",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-03-05",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "A.S.D. POL. GS RODANO",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-03-06",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "MARTESANA VOLLEY COLOGNO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALAZZO SPORT",
        "localita": "COLOGNO MONZESE - VIA VOLTA"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-03-06",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "GONZAGA YOUNG",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "CENTRO SPORTIVO CRESPI",
        "localita": "MILANO - VIA VALVASSORI PERONI"
      }
    ]
  },
  {
    "settimana": "2026-W11",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-03-12",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "VOLLEY LUCERNATE",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-03-13",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "SSD SRL POL. SAN GIULIANO",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA MEDIA E.FERMI",
        "localita": "SAN GIULIANO MILANESE - VIA SESTO GALLO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-03-13",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "CITTA' DI OPERA",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W12",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-03-19",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "ASD ASS. GENITORI SCUOLE",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-03-20",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "A.S.D. ORATORIO OGGIONO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALAZZETTO POLIFUNZIONALE ORATORIO",
        "localita": "OGGIONO - VIALE VITTORIA"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-03-20",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "PIZZAUT PALLAVOLO CASSINA ROSSA",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "SCUOLA ELEMENTARE TRENTO",
        "localita": "CASSINA DE' PECCHI - VIA TRENTO"
      }
    ]
  },
  {
    "settimana": "2026-W13",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-03-26",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "VOLLEY BARZANO'",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-03-27",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "ASD PGS ARDOR",
        "ospite": "ASD ZERONOVE",
        "campo": "CENTRO SALESIANO MELZO",
        "localita": "MELZO - VIA FORMENTI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-03-27",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "O.F.I.",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W14",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-04-02",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "CEM TORRICELLI",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-04-02",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "A.S.D. NEW VOLLEY ADDA",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALAZZETTO SANSONA",
        "localita": "CASSANO D'ADDA - VIA PAPA GIOVANNI XXIII"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-04-02",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "PALLAVOLO GSA",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "ITIS LEONARDO DA VINCI",
        "localita": "CARATE BRIANZA - VIA DE GASPERI"
      }
    ]
  },
  {
    "settimana": "2026-W15",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-04-09",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "CORALYA LISSONE VOLLEY TEAM",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-04-10",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-04-10",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W16",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-04-16",
        "giorno": "Thursday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "POL. SAN GIORGIO",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-04-16",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "A.S.D. POL. GS RODANO",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALAZZETTO COMUNALE C/O SM",
        "localita": "RODANO - VIA TURATI (LARGO 11 SETTEMBRE 2001)"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-04-17",
        "giorno": "Friday",
        "ora": "21.00",
        "casa": "REDSTAMP VOLLEY VALLE DEL LAMBRO",
        "ospite": "AVIS CERNUSCO BIANCA",
        "campo": "PALESTRA SCUOLA ELEMENTARE",
        "localita": "CORREZZANA - VIA A. DE GASPERI"
      }
    ]
  },
  {
    "settimana": "2026-W17",
    "partite": [
      {
        "squadra": "Avis Cernusco",
        "data": "2026-04-23",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "UNION VOLLEY MARIANO",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-04-24",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "GONZAGA YOUNG",
        "ospite": "ASD ZERONOVE",
        "campo": "CENTRO SPORTIVO CRESPI",
        "localita": "MILANO - VIA VALVASSORI PERONI"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-04-24",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "SSD SRL POL. SAN GIULIANO",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  },
  {
    "settimana": "2026-W18",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-04-28",
        "giorno": "Tuesday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "CITTA' DI OPERA",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-04-29",
        "giorno": "Wednesday",
        "ora": "21.15",
        "casa": "ASD ASS. GENITORI SCUOLE",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "SCUOLA MEDIA GRAMSCI",
        "localita": "MILANO - VIA FRANCO TOSI"
      }
    ]
  },
  {
    "settimana": "2026-W19",
    "partite": [
      {
        "squadra": "ASD Zeronove",
        "data": "2026-05-05",
        "giorno": "Tuesday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-05-05",
        "giorno": "Tuesday",
        "ora": "21.00",
        "casa": "ASD ZERONOVE",
        "ospite": "POLISPORTIVA CARUGATE",
        "campo": "PALESTRA SCUOLA MEDIA LEOPARDI",
        "localita": "SEGRATE - VIA SAN ROCCO"
      },
      {
        "squadra": "Avis Cernusco",
        "data": "2026-05-07",
        "giorno": "Thursday",
        "ora": "21.15",
        "casa": "AVIS CERNUSCO BIANCA",
        "ospite": "GEAS VOLLEY ASD",
        "campo": "NUOVO PALASPORT COMUNALE - SUSSIDIARIA",
        "localita": "CERNUSCO SUL NAVIGLIO - VIA BUONARROTI"
      },
      {
        "squadra": "ASD Zeronove",
        "data": "2026-05-08",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "PIZZAUT PALLAVOLO CASSINA ROSSA",
        "ospite": "ASD ZERONOVE",
        "campo": "SCUOLA ELEMENTARE TRENTO",
        "localita": "CASSINA DE' PECCHI - VIA TRENTO"
      },
      {
        "squadra": "Polisportiva Carugate",
        "data": "2026-05-08",
        "giorno": "Friday",
        "ora": "21.15",
        "casa": "POLISPORTIVA CARUGATE",
        "ospite": "ASD PGS ARDOR",
        "campo": "SCUOLA ELEMENTARE NUOVA",
        "localita": "CARUGATE - VIA DEL GINESTRINO"
      }
    ]
  }
]

    </script>
    <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
    <script>
        // Coordinate lookup tables and dynamic dataset loading
        const locationCoordinates = {
            "CENTRO SALESIANO MELZO|MELZO - VIA FORMENTI": { lat: 45.5039, lng: 9.4181 },
            "CENTRO SCOLASTICO UNIONE EUROPEA|MILANO - VIA SAN DIONIGI": { lat: 45.4309, lng: 9.2394 },
            "CENTRO SPORTIVO CRESPI|MILANO - VIA VALVASSORI PERONI": { lat: 45.4810, lng: 9.2276 },
            "CENTRO SPORTIVO PAOLO VI|BARZANO' - VIA GIOVANNI PAOLO XXIII": { lat: 45.7240, lng: 9.3245 },
            "I.I.S. V.F. PARETO - CAMPO 1|MILANO - VIA LITTA MODIGNANI": { lat: 45.5200, lng: 9.1555 },
            "ISTITUTO ERASMO DA ROTTERDAM|SESTO SAN GIOVANNI - VIA CANTORE (ANG.V.LE ITALIA 409)": { lat: 45.5355, lng: 9.2354 },
            "ITC VERRI 1'' PIANO|MILANO - VIA LATTANZIO": { lat: 45.4528, lng: 9.2097 },
            "ITIS LEONARDO DA VINCI|CARATE BRIANZA - VIA DE GASPERI": { lat: 45.6765, lng: 9.2335 },
            "NUOVO PALASPORT COMUNALE - SUSSIDIARIA|CERNUSCO SUL NAVIGLIO - VIA BUONARROTI": { lat: 45.5236, lng: 9.3319 },
            "PALAZZETTO COMUNALE C/O SM|RODANO - VIA TURATI (LARGO 11 SETTEMBRE 2001)": { lat: 45.4786, lng: 9.3660 },
            "PALAZZETTO DELLO SPORT|MARIANO COMENSE - VIA SANT'ANTONIO DA PADONA": { lat: 45.6940, lng: 9.1900 },
            "PALAZZETTO DELLO SPORT 'CARLO GALIMBERTI'|BOLLATE - VIA VARALLI": { lat: 45.5530, lng: 9.1140 },
            "PALAZZETTO PIERMARINI|LISSONE - VIA BERNINI": { lat: 45.6120, lng: 9.2430 },
            "PALAZZETTO POLIFUNZIONALE ORATORIO|OGGIONO - VIALE VITTORIA": { lat: 45.8000, lng: 9.3510 },
            "PALAZZETTO SANSONA|CASSANO D'ADDA - VIA PAPA GIOVANNI XXIII": { lat: 45.5280, lng: 9.5230 },
            "PALAZZO SPORT|COLOGNO MONZESE - VIA VOLTA": { lat: 45.5350, lng: 9.2760 },
            "PALESTRA COMUNALE|INZAGO - VIA BRAMBILLA": { lat: 45.5875, lng: 9.4633 },
            "PALESTRA COMUNALE LISCATE|LISCATE - VIA DANTE ALIGHIERI": { lat: 45.4887, lng: 9.3950 },
            "PALESTRA COMUNALE OPERA|OPERA - VIA DANTE ALIGHIERI": { lat: 45.3740, lng: 9.2080 },
            "PALESTRA SCUOLA ELEMENTARE|CORREZZANA - VIA A. DE GASPERI": { lat: 45.6600, lng: 9.2910 },
            "PALESTRA SCUOLA MEDIA LEOPARDI|SEGRATE - VIA SAN ROCCO": { lat: 45.4951, lng: 9.2961 },
            "PALESTRA SCUOLE MEDIE CLEMENTE BARONI NUOVA|CARUGATE - VIA S. FRANCESCO D'ASSISI (ANGOLO VIA FIDELINA": { lat: 45.5540, lng: 9.3356 },
            "S.E. DI LUCERNATE|RHO - LUCERNATE - VIA GIULIO CESARE - INGRESSO VIA VERBAN": { lat: 45.5320, lng: 9.0450 },
            "SCUOLA EL. MARTIRI DELLA LIBERTA''|SESTO SAN GIOVANNI - VIA FIORANI (DI FRONTE AL CIVICO 93)": { lat: 45.5330, lng: 9.2260 },
            "SCUOLA ELEMENTARE NUOVA|CARUGATE - VIA DEL GINESTRINO": { lat: 45.5542, lng: 9.3356 },
            "SCUOLA ELEMENTARE TRENTO|CASSINA DE' PECCHI - VIA TRENTO": { lat: 45.5300, lng: 9.3560 },
            "SCUOLA MEDIA BUONARROTI|MILANO - VIA SCIALOIA": { lat: 45.5051, lng: 9.2280 },
            "SCUOLA MEDIA E.FERMI|SAN GIULIANO MILANESE - VIA SESTO GALLO": { lat: 45.3930, lng: 9.2700 },
            "SCUOLA MEDIA GRAMSCI|MILANO - VIA FRANCO TOSI": { lat: 45.5000, lng: 9.2290 },
            "TENSOSTRUTTURA BRESSO|BRESSO - VIA DON MINZONI": { lat: 45.5420, lng: 9.1880 }
        };

        const cityCoordinates = {
            "BARZANO'": { lat: 45.7240, lng: 9.3245 },
            "BOLLATE": { lat: 45.5530, lng: 9.1160 },
            "BRESSO": { lat: 45.5420, lng: 9.1860 },
            "CARATE BRIANZA": { lat: 45.6760, lng: 9.2330 },
            "CARUGATE": { lat: 45.5530, lng: 9.3350 },
            "CASSANO D'ADDA": { lat: 45.5280, lng: 9.5230 },
            "CASSINA DE' PECCHI": { lat: 45.5300, lng: 9.3560 },
            "CERNUSCO SUL NAVIGLIO": { lat: 45.5236, lng: 9.3319 },
            "COLOGNO MONZESE": { lat: 45.5298, lng: 9.2750 },
            "CORREZZANA": { lat: 45.6600, lng: 9.2910 },
            "INZAGO": { lat: 45.5488, lng: 9.5035 },
            "LISCATE": { lat: 45.4887, lng: 9.3950 },
            "LISSONE": { lat: 45.6130, lng: 9.2420 },
            "MARIANO COMENSE": { lat: 45.6925, lng: 9.1798 },
            "MELZO": { lat: 45.5039, lng: 9.4181 },
            "MILANO": { lat: 45.4642, lng: 9.1900 },
            "OGGIONO": { lat: 45.8000, lng: 9.3510 },
            "OPERA": { lat: 45.3740, lng: 9.2080 },
            "RHO": { lat: 45.5320, lng: 9.0450 },
            "RODANO": { lat: 45.4890, lng: 9.3350 },
            "SAN GIULIANO MILANESE": { lat: 45.3940, lng: 9.2760 },
            "SEGRATE": { lat: 45.5030, lng: 9.2980 },
            "SESTO SAN GIOVANNI": { lat: 45.5340, lng: 9.2250 }
        };

        let matchesData = [];

        function normalizeTime(timeString) {
            if (!timeString) return '';
            return timeString.includes(':') ? timeString : timeString.replace(/\./g, ':');
        }

        function enrichMatch(partita, settimana) {
            const normalized = { ...partita };
            normalized.settimana = settimana;
            normalized.ora = normalizeTime(normalized.ora);

            const locationKey = `${normalized.campo}|${normalized.localita}`;
            const coords = locationCoordinates[locationKey];
            if (coords) {
                normalized.lat = coords.lat;
                normalized.lng = coords.lng;
            } else {
                const city = normalized.localita.split(' - ')[0];
                const cityCoords = cityCoordinates[city];
                if (cityCoords) {
                    normalized.lat = cityCoords.lat;
                    normalized.lng = cityCoords.lng;
                }
            }

            return normalized;
        }

        async function loadMatchesData() {
            try {
                let weekly = null;

                if (window.location.protocol !== 'file:') {
                    try {
                        const response = await fetch('calendario_settimanale_FINALE.json', { cache: 'no-cache' });
                        if (!response.ok) {
                            throw new Error(`HTTP ${response.status}`);
                        }
                        weekly = await response.json();
                    } catch (fetchError) {
                        console.warn('Fetch del calendario fallito, uso fallback locale', fetchError);
                    }
                }

                if (!weekly) {
                    const fallbackScript = document.getElementById('calendar-data');
                    if (fallbackScript) {
                        weekly = JSON.parse(fallbackScript.textContent);
                    }
                }

                if (!weekly) {
                    throw new Error('Nessun dato disponibile');
                }

                matchesData = weekly
                    .flatMap(week => week.partite.map(partita => enrichMatch(partita, week.settimana)))
                    .sort((a, b) => {
                        const dateDiff = new Date(a.data) - new Date(b.data);
                        if (dateDiff !== 0) return dateDiff;
                        const timeDiff = a.ora.localeCompare(b.ora);
                        if (timeDiff !== 0) return timeDiff;
                        return a.squadra.localeCompare(b.squadra);
                    });

                populateWeekFilter();
                const teamValue = document.getElementById('team-filter').value;
                const weekValue = document.getElementById('week-filter').value;
                populateWeeklyTable(teamValue, weekValue);
                populateCalendar(teamValue, weekValue);
                if (map) {
                    populateMap(teamValue, weekValue);
                }
            } catch (error) {
                console.error('Errore nel caricamento del calendario:', error);

                const tableBody = document.getElementById('weekly-table-body');
                if (tableBody && tableBody.children.length === 0) {
                    const row = document.createElement('tr');
                    const cell = document.createElement('td');
                    cell.colSpan = 6;
                    cell.className = 'no-matches';
                    cell.textContent = 'Impossibile caricare il calendario';
                    row.appendChild(cell);
                    tableBody.appendChild(row);
                }

                const calendarContainer = document.getElementById('calendar-container');
                if (calendarContainer && calendarContainer.children.length === 0) {
                    calendarContainer.innerHTML = '<div class="no-matches">Impossibile caricare il calendario</div>';
                }
            }
        }

        // Team configurations
        const teams = {
            'avis': { name: 'Avis Cernusco', color: '#ffffff', borderColor: '#333333', markerColor: 'white' },
            'zeronove': { name: 'ASD Zeronove', color: '#000000', markerColor: 'black' },
            'carugate': { name: 'Polisportiva Carugate', color: '#3b82f6', markerColor: 'blue' }
        };

        // Helper function to get week number
        function getWeekNumber(date) {
            const d = new Date(date);
            d.setHours(0, 0, 0, 0);
            d.setDate(d.getDate() + 4 - (d.getDay() || 7));
            const yearStart = new Date(d.getFullYear(), 0, 1);
            const weekNo = Math.ceil((((d - yearStart) / 86400000) + 1) / 7);
            return `${d.getFullYear()}-W${weekNo.toString().padStart(2, '0')}`;
        }

        // Helper function to get week date range
        function getWeekDateRange(weekId) {
            const [year, week] = weekId.split('-W');
            const simple = new Date(year, 0, 1 + (week - 1) * 7);
            const dow = simple.getDay();
            const ISOweekStart = simple;
            if (dow <= 4)
                ISOweekStart.setDate(simple.getDate() - simple.getDay() + 1);
            else
                ISOweekStart.setDate(simple.getDate() + 8 - simple.getDay());
            const weekEnd = new Date(ISOweekStart);
            weekEnd.setDate(weekEnd.getDate() + 6);
            return {
                start: ISOweekStart,
                end: weekEnd,
                label: `${ISOweekStart.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' })} - ${weekEnd.toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit', year: 'numeric' })}`
            };
        }

        // Helper function to get team key from squad name
        function getTeamKey(squadra) {
            if (squadra.includes('Avis') || squadra.includes('AVIS')) return 'avis';
            if (squadra.includes('Zeronove') || squadra.includes('ZERONOVE')) return 'zeronove';
            if (squadra.includes('Carugate') || squadra.includes('CARUGATE')) return 'carugate';
            return null;
        }

        // Organize matches by week
        function organizeMatchesByWeek() {
            const weeklyData = {};
            
            matchesData.forEach(match => {
                const weekId = getWeekNumber(match.data);
                if (!weeklyData[weekId]) {
                    weeklyData[weekId] = {
                        matches: [],
                        avis: [],
                        zeronove: [],
                        carugate: []
                    };
                }
                weeklyData[weekId].matches.push(match);
                const teamKey = getTeamKey(match.squadra);
                if (teamKey) {
                    weeklyData[weekId][teamKey].push(match);
                }
            });
            
            return weeklyData;
        }

        // Check for overlaps in a week
        function checkOverlaps(weekData) {
            const dates = {};
            weekData.matches.forEach(match => {
                if (!dates[match.data]) dates[match.data] = [];
                dates[match.data].push(getTeamKey(match.squadra));
            });
            
            let hasOverlap = false;
            for (const date in dates) {
                if (dates[date].length > 1) {
                    hasOverlap = true;
                    break;
                }
            }
            
            return { hasOverlap, dates };
        }

        // Populate weekly table
        function populateWeeklyTable(filterTeam = 'all', filterWeek = 'all') {
            const weeklyData = organizeMatchesByWeek();
            const tableBody = document.getElementById('weekly-table-body');
            tableBody.innerHTML = '';
            
            const sortedWeeks = Object.keys(weeklyData).sort();
            
            sortedWeeks.forEach(weekId => {
                if (filterWeek !== 'all' && filterWeek !== weekId) return;
                
                const weekData = weeklyData[weekId];
                const weekRange = getWeekDateRange(weekId);
                const overlapInfo = checkOverlaps(weekData);
                
                // Apply team filter
                let displayRow = false;
                if (filterTeam === 'all') {
                    displayRow = true;
                } else if (filterTeam === 'avis' && weekData.avis.length > 0) {
                    displayRow = true;
                } else if (filterTeam === 'zeronove' && weekData.zeronove.length > 0) {
                    displayRow = true;
                } else if (filterTeam === 'carugate' && weekData.carugate.length > 0) {
                    displayRow = true;
                }
                
                if (!displayRow) return;
                
                const row = document.createElement('tr');
                
                // Week column
                const weekCell = document.createElement('td');
                weekCell.innerHTML = `<strong>${weekId}</strong>`;
                row.appendChild(weekCell);
                
                // Dates column
                const datesCell = document.createElement('td');
                const uniqueDates = [...new Set(weekData.matches.map(m => m.data))].sort();
                datesCell.textContent = uniqueDates.map(d => new Date(d).toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' })).join(', ');
                row.appendChild(datesCell);
                
                // Avis column
                const avisCell = document.createElement('td');
                if (weekData.avis.length > 0) {
                    avisCell.innerHTML = `${weekData.avis.length} partita/e<br><small>${weekData.avis.map(m => new Date(m.data).toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' })).join(', ')}</small>`;
                } else {
                    avisCell.innerHTML = '<span style="color: var(--color-text-secondary);">-</span>';
                }
                row.appendChild(avisCell);
                
                // Zeronove column
                const zeronoveCell = document.createElement('td');
                if (weekData.zeronove.length > 0) {
                    zeronoveCell.innerHTML = `${weekData.zeronove.length} partita/e<br><small>${weekData.zeronove.map(m => new Date(m.data).toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' })).join(', ')}</small>`;
                } else {
                    zeronoveCell.innerHTML = '<span style="color: var(--color-text-secondary);">-</span>';
                }
                row.appendChild(zeronoveCell);
                
                // Carugate column
                const carugateCell = document.createElement('td');
                if (weekData.carugate.length > 0) {
                    carugateCell.innerHTML = `${weekData.carugate.length} partita/e<br><small>${weekData.carugate.map(m => new Date(m.data).toLocaleDateString('it-IT', { day: '2-digit', month: '2-digit' })).join(', ')}</small>`;
                } else {
                    carugateCell.innerHTML = '<span style="color: var(--color-text-secondary);">-</span>';
                }
                row.appendChild(carugateCell);
                
                // Overlaps column
                const overlapCell = document.createElement('td');
                if (overlapInfo.hasOverlap) {
                    overlapCell.innerHTML = '<span class="overlap-badge">S</span>';
                } else {
                    overlapCell.innerHTML = '<span class="no-overlap-badge">No</span>';
                }
                row.appendChild(overlapCell);
                
                tableBody.appendChild(row);
            });
            
            if (tableBody.children.length === 0) {
                const row = document.createElement('tr');
                const cell = document.createElement('td');
                cell.colSpan = 6;
                cell.className = 'no-matches';
                cell.textContent = 'Nessuna partita trovata per i filtri selezionati';
                row.appendChild(cell);
                tableBody.appendChild(row);
            }
        }

        // Populate calendar view
        function populateCalendar(filterTeam = 'all', filterWeek = 'all') {
            const weeklyData = organizeMatchesByWeek();
            const container = document.getElementById('calendar-container');
            container.innerHTML = '';
            
            const sortedWeeks = Object.keys(weeklyData).sort();
            
            sortedWeeks.forEach(weekId => {
                if (filterWeek !== 'all' && filterWeek !== weekId) return;
                
                const weekData = weeklyData[weekId];
                const weekRange = getWeekDateRange(weekId);
                
                // Filter matches by team
                let filteredMatches = weekData.matches;
                if (filterTeam !== 'all') {
                    filteredMatches = weekData.matches.filter(m => getTeamKey(m.squadra) === filterTeam);
                }
                
                if (filteredMatches.length === 0) return;
                
                const weekCard = document.createElement('div');
                weekCard.className = 'week-card';
                
                const weekHeader = document.createElement('div');
                weekHeader.className = 'week-header';
                weekHeader.textContent = `${weekId} - ${weekRange.label}`;
                weekCard.appendChild(weekHeader);
                
                const matchesGrid = document.createElement('div');
                matchesGrid.className = 'matches-grid';
                
                filteredMatches
                    .sort((a, b) => {
                        const dateDiff = new Date(a.data) - new Date(b.data);
                        if (dateDiff !== 0) return dateDiff;
                        return a.ora.localeCompare(b.ora);
                    })
                    .forEach(match => {
                    const matchItem = document.createElement('div');
                    const teamKey = getTeamKey(match.squadra);
                    matchItem.className = `match-item ${teamKey}`;
                    
                    matchItem.innerHTML = `
                        <div class="match-header">
                            <span class="match-team">${match.squadra}</span>
                            <span class="match-date">${new Date(match.data).toLocaleDateString('it-IT', { weekday: 'short', day: '2-digit', month: 'short' })} - ${match.ora}</span>
                        </div>
                        <div class="match-vs">${match.casa} vs ${match.ospite}</div>
                        <div class="match-location"> ${match.campo}, ${match.localita}</div>
                    `;
                    
                    matchesGrid.appendChild(matchItem);
                });
                
                weekCard.appendChild(matchesGrid);
                container.appendChild(weekCard);
            });
            
            if (container.children.length === 0) {
                container.innerHTML = '<div class="no-matches">Nessuna partita trovata per i filtri selezionati</div>';
            }
        }

        // Initialize map
        let map = null;
        let markersLayer = null;

        function initializeMap() {
            if (!map) {
                // Center map on Milan area
                map = L.map('map').setView([45.5236, 9.2411], 10);
                
                L.tileLayer('https://{s}.tile.openstreetmap.org/{z}/{x}/{y}.png', {
                    attribution: '&copy; <a href="https://www.openstreetmap.org/copyright" target="_blank">OpenStreetMap</a> contributors',
                    maxZoom: 19
                }).addTo(map);
                
                markersLayer = L.layerGroup().addTo(map);
            }
        }

        function populateMap(filterTeam = 'all', filterWeek = 'all') {
            if (!map) {
                initializeMap();
            }
            
            markersLayer.clearLayers();
            
            // Group matches by location
            const locationGroups = {};
            
            matchesData.forEach(match => {
                const weekId = getWeekNumber(match.data);
                const teamKey = getTeamKey(match.squadra);
                
                // Apply filters
                if (filterTeam !== 'all' && teamKey !== filterTeam) return;
                if (filterWeek !== 'all' && weekId !== filterWeek) return;

                if (typeof match.lat !== 'number' || typeof match.lng !== 'number' || Number.isNaN(match.lat) || Number.isNaN(match.lng)) {
                    return;
                }
                
                const locKey = `${match.lat},${match.lng}`;
                if (!locationGroups[locKey]) {
                    locationGroups[locKey] = {
                        lat: match.lat,
                        lng: match.lng,
                        campo: match.campo,
                        localita: match.localita,
                        matches: []
                    };
                }
                locationGroups[locKey].matches.push(match);
            });
            
            // Create markers
            Object.values(locationGroups).forEach(location => {
                // Determine marker color (use first match's team)
                const teamKey = getTeamKey(location.matches[0].squadra);
                let iconHtml = '';
                if (teamKey === 'avis') {
                    iconHtml = '<div style="background-color: white; border: 3px solid #333; width: 25px; height: 25px; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>';
                } else if (teamKey === 'zeronove') {
                    iconHtml = '<div style="background-color: black; width: 25px; height: 25px; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>';
                } else if (teamKey === 'carugate') {
                    iconHtml = '<div style="background-color: #3b82f6; width: 25px; height: 25px; border-radius: 50%; box-shadow: 0 2px 5px rgba(0,0,0,0.3);"></div>';
                }
                
                const icon = L.divIcon({
                    html: iconHtml,
                    className: 'custom-marker',
                    iconSize: [25, 25],
                    iconAnchor: [12, 12]
                });
                
                const marker = L.marker([location.lat, location.lng], { icon: icon });
                
                // Create popup content
                let popupContent = `
                    <div class="popup-content">
                        <h3>${location.campo}</h3>
                        <p><strong>${location.localita}</strong></p>
                        <p><strong>Partite:</strong></p>
                        <ul style="margin: 4px 0; padding-left: 20px;">
                `;
                
                location.matches.forEach(match => {
                    popupContent += `<li style="font-size: 12px; margin: 2px 0;">${match.squadra} - ${new Date(match.data).toLocaleDateString('it-IT')} ${match.ora}</li>`;
                });
                
                popupContent += `
                        </ul>
                        <a href="https://www.google.com/maps/search/?api=1&query=${encodeURIComponent(location.localita + ' ' + location.campo)}" target="_blank" class="popup-link">Apri in Google Maps</a>
                    </div>
                `;
                
                marker.bindPopup(popupContent);
                marker.addTo(markersLayer);
            });
            
            // Fit bounds if there are markers
            if (Object.keys(locationGroups).length > 0) {
                const bounds = L.latLngBounds(Object.values(locationGroups).map(loc => [loc.lat, loc.lng]));
                map.fitBounds(bounds, { padding: [50, 50] });
            }
        }

        // Populate week filter
        function populateWeekFilter() {
            const weekFilter = document.getElementById('week-filter');
            const weeklyData = organizeMatchesByWeek();
            const sortedWeeks = Object.keys(weeklyData).sort();

            weekFilter.innerHTML = '<option value="all">Tutte le settimane</option>';

            sortedWeeks.forEach(weekId => {
                const weekRange = getWeekDateRange(weekId);
                const option = document.createElement('option');
                option.value = weekId;
                option.textContent = `${weekId} (${weekRange.label})`;
                weekFilter.appendChild(option);
            });

            weekFilter.value = 'all';
        }

        // View switching
        const viewTabs = document.querySelectorAll('.view-tab');
        const viewContents = document.querySelectorAll('.view-content');
        
        viewTabs.forEach(tab => {
            tab.addEventListener('click', () => {
                const viewName = tab.dataset.view;
                
                viewTabs.forEach(t => t.classList.remove('active'));
                tab.classList.add('active');
                
                viewContents.forEach(content => content.classList.remove('active'));
                document.getElementById(`${viewName}-view`).classList.add('active');
                
                // Initialize map when map view is opened
                if (viewName === 'map' && !map) {
                    setTimeout(() => {
                        const teamFilter = document.getElementById('team-filter').value;
                        const weekFilter = document.getElementById('week-filter').value;
                        populateMap(teamFilter, weekFilter);
                    }, 100);
                } else if (viewName === 'map' && map) {
                    setTimeout(() => map.invalidateSize(), 100);
                }
            });
        });

        // Filter handling
        document.getElementById('team-filter').addEventListener('change', (e) => {
            const teamValue = e.target.value;
            const weekValue = document.getElementById('week-filter').value;
            
            populateWeeklyTable(teamValue, weekValue);
            populateCalendar(teamValue, weekValue);
            if (map) {
                populateMap(teamValue, weekValue);
            }
        });

        document.getElementById('week-filter').addEventListener('change', (e) => {
            const weekValue = e.target.value;
            const teamValue = document.getElementById('team-filter').value;
            
            populateWeeklyTable(teamValue, weekValue);
            populateCalendar(teamValue, weekValue);
            if (map) {
                populateMap(teamValue, weekValue);
            }
        });

        // Initialize on page load
        document.addEventListener('DOMContentLoaded', () => {
            loadMatchesData();
        });
    </script>
</body>
</html>
